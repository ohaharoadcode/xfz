function BannerManage(n){this._init(n),this.run()}BannerManage.prototype={_init:function(n){this.wrapper=$(n.wrapper),this.add_btn=$(n.add_btn),this.delete_btn=$(".delete_banner"),this.submit_btn=$(".submit-btn")},run:function(){this.add_banner(),this.delete_banner(),this.upload_img(),this.submit()},add_banner:function(){var e=this;e.add_btn.click(function(){var n=template("banner-card",0);e.wrapper.prepend(n)})},delete_banner:function(){this.wrapper.on("click",".delete_banner",function(){var e=$(this).parents(".per-banner"),t=e.attr("name");t?swal({icon:"warning",title:"确定删除？",text:"删除后将无法恢复！",buttons:["取消","删除"],dangerMode:!0}).then(function(n){n&&xfz_ajax.post({url:"/cms/delete_banner/",data:{id:t},success:function(n){200===n.code?(e.remove(),swal({icon:"success",title:"删除成功",timer:1500})):swal({icon:"error",title:"该轮播图不存在！",timer:2e3})}})}):e.remove()})},upload_img:function(){this.wrapper.on("change",'input[name="banner_img"]',function(){var n=this.files[0],e=new FormData;e.append("banner_img",n),xfz_ajax.post({url:"/cms/banner_img_upload/",data:e,processData:!1,contentType:!1,success:function(n){200===n.code&&$(this).parent().find("img").attr("src",n.data.url)}.bind(this)})})},submit:function(){this.wrapper.on("click",".submit-btn",function(){var t=$(this).parents(".per-banner"),n=t.find(".banner-img-wrapper img").attr("src"),a=t.find(".banner_priority").val(),e=t.find(".banner_url").val(),i=t.attr("name");xfz_ajax.post({url:"/cms/banner_manage",data:{id:i,banner_img:n,link_url:e,priority:a},success:function(n){if(200===n.code){var e=n.data.name;swal({icon:"success",title:n.message,timer:1e3}).then(function(){t.attr("name",e),t.find(".position priority").text("优先级为"+a)})}else swal({icon:"error",title:n.message,timer:1500})}})})}},$(function(){new BannerManage({add_btn:".add_banner",wrapper:".banner-wrapper"})});